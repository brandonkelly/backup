{% extends "enupal-backup/_layouts/settings" %}
{% import "_includes/forms" as forms %}

{% set settings = craft.enupalbackup.getSettings() %}
{% set fullPageForm = true %}
{% set saveShortcutRedirect = 'enupal-backup/settings/webhook' %}

{% set saveButton %}
	<div class="buttons">
		<input class="btn submit" type="submit" value="{{ 'Save'|t }}">
	</div>
{% endset %}

{% set content %}

	<input type="hidden" name="action" value="enupal-backup/settings/save-settings">

	<div id="settings-cp">

		{% namespace 'settings' %}
			{{ forms.field({
				label: "Webhook"|t('enupal-backup')|upper,
				instructions: ""|t('enupal-backup'),
			}, null) }}
			<hr>

			{{ forms.textField({
					label: "Webhook URL"|t('enupal-backup'),
					instructions: "Absolute Url"|t('enupal-backup'),
					id: 'webhookUrl',
					name: 'webhookUrl',
					value: settings.webhookUrl,
					autofocus: true,
					first: true,
					errors: ''
				}) }}

			<hr>
			{{ forms.textField({
					label: "Secret Key"|t('enupal-backup'),
					instructions: "Secret key for webhook"|t('enupal-backup'),
					id: 'webhookSecretKey',
					name: 'webhookSecretKey',
					value: settings.webhookSecretKey,
					autofocus: true,
					first: true,
					errors: ''
				}) }}
		{% endnamespace %}
		<hr>
		{% if settings.webhookUrl and settings.webhookSecretKey%}
			<h3> <a href="{{settings.webhookUrl ~'?secret='~settings.webhookSecretKey}}">{{settings.webhookUrl ~'?secret='~settings.webhookSecretKey}}</a> </h3>
		{% endif %}

	</div>

{% endset %}